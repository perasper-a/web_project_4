!function(){"use strict";var e=class{constructor(e,t){this.settings=e,this.formElement=t,this.button=this.formElement.querySelector(this.settings.submitButtonSelector),this.inputList=[...this.formElement.querySelectorAll(this.settings.inputSelector)]}resetFormErrors(){this.inputList.forEach((e=>{this._hideInputError(e)}))}resetValidation(){this._toggleButton(),this.resetFormErrors()}_hasValidInputs=()=>this.inputList.every((e=>!0===e.validity.valid));_enableButton(){this.button.classList.remove(this.settings.inactiveButtonClass),this.button.disabled=!1}disableButton(){this.button.classList.add(this.settings.inactiveButtonClass),this.button.disabled=!0}_toggleButton=()=>{this._hasValidInputs()?this._enableButton():this.disableButton()};_showInputError=e=>{const{inputErrorClass:t}=this.settings;this.formElement.querySelector(`#${e.id}-error`).textContent=e.validationMessage,e.classList.add(t)};_hideInputError=e=>{const{inputErrorClass:t}=this.settings;this.formElement.querySelector(`#${e.id}-error`).textContent="",e.classList.remove(t)};_checkInputValidity=e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)};_setEventListener=()=>{this.inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton()}))}))};enableValidation(){this.formElement.addEventListener("submit",(e=>e.preventDefault())),this._setEventListener()}};class t{constructor(e,t,s){this._data=e,this._cardTemplateSelector=t,this._handleImageClick=s}_getTemplate(){return document.querySelector(this._cardTemplateSelector).content.querySelector(".card")}_handleCardDeleteButton=()=>this._cardElement.remove();_handleLikeButton=e=>{e.target.classList.toggle("card__like-button_filled")};_addEventListeners=()=>{this._cardImage.addEventListener("click",(()=>this._handleImageClick())),this._cardDeleteButton.addEventListener("click",this._handleCardDeleteButton),this._cardLikeButton.addEventListener("click",this._handleLikeButton)};createCard=()=>(this._cardElement=this._getTemplate().cloneNode(!0),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardDeleteButton=this._cardElement.querySelector(".card__trash-button"),this._cardLikeButton=this._cardElement.querySelector(".card__like-button"),this._cardImage.style.backgroundImage=`url(${this._data.link})`,this._cardElement.querySelector(".card__title").textContent=this._data.name,this._addEventListeners(),this._cardElement)}class s{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close"))&&this.close()}))}}class n extends s{constructor(e,t){super(e),this._handleSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._inputList=Array.from(this._popup.querySelectorAll(".form__input"))}_getInputValues(){const e={};return this._inputList.forEach((t=>{let{name:s,value:n}=t;e[s]=n})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit(this._getInputValues())}))}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}close(){super.close(),this._form.reset()}}const o={inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type-error",errorClass:"form__input-error"},i=document.querySelector(".profile__name-button"),r=document.querySelector(".profile__button-add"),a=document.querySelector(".cards__list"),l=document.querySelector(".popup__form_profile"),c=document.querySelector(".popup__form_card"),d=(document.querySelector(".form__input_type_name"),document.querySelector(".form__input_type_job"),new n(".popup_type_add-card",(e=>{p({name:e.title,link:e.link},a),d.close()})));d.setEventListeners();const u=new n(".popup_type_profile",(e=>{m.setUserInfo(e.name,e.job),u.close()}));u.setEventListeners();const _=new class extends s{open(e,t){const s=document.querySelector(".popup__image"),n=document.querySelector(".popup__caption");s.src=t,s.alt=e,n.textContent=e,super.open()}}(".popup_type_preview");_.setEventListeners();const p=e=>{const s=function(e){return new t(e,"#card-template",(()=>{_.open(e.name,e.link)})).createCard()}(e);h.addItem(s)},h=new class{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}renderItems(){this._items.forEach(this._renderer)}addItem(e){this._container.prepend(e)}}({items:[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}],renderer:p},".cards__list");h.renderItems();const m=new class{constructor(e){let{profileNameSelector:t,profileJobSelector:s}=e;this._profileName=document.querySelector(t),this._profileJob=document.querySelector(s)}getUserInfo(){return{name:this._profileName.textContent,job:this._profileJob.textContent}}setUserInfo(e,t){this._profileName.textContent=e,this._profileJob.textContent=t}}({profileNameSelector:".profile__name-info",profileJobSelector:".profile__info-job"});i.addEventListener("click",(function(){const e=m.getUserInfo();u.open(),u.setInputValues(e),f.resetValidation()})),r.addEventListener("click",(function(){d.open(),E.disableButton(),E.resetValidation()}));const f=new e(o,l),E=new e(o,c);f.enableValidation(),E.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNMNUQsS0FBTTNELEtBQUtxSCxhQUFhMUYsWUFDeEJzRSxJQUFLakcsS0FBS3NILFlBQVkzRixZQUUxQixDQUNBcUUsWUFBWXJDLEVBQU1zQyxHQUNoQmpHLEtBQUtxSCxhQUFhMUYsWUFBY2dDLEVBQ2hDM0QsS0FBS3NILFlBQVkzRixZQUFjc0UsQ0FDakMsR0grRDRCLENBQzVCa0Isb0JEbkJpQyxzQkNvQmpDQyxtQkRuQmdDLHVCQ3NCbEM3QixFQUFvQnhELGlCQUFpQixTQUFTLFdBQzVDLE1BQU15RixFQUFjekIsRUFBU3dCLGNBQzdCekIsRUFBZ0IxQixPQUNoQjBCLEVBQWdCVixlQUFlb0MsR0FDL0JDLEVBQXFCOUcsaUJBQ3ZCLElBRUE2RSxFQUF1QnpELGlCQUFpQixTQUFTLFdBQy9DNkQsRUFBYXhCLE9BRWJzRCxFQUFxQnBHLGdCQUNyQm9HLEVBQXFCL0csaUJBQ3ZCLElBR0EsTUFBTThHLEVBQXVCLElBQUlFLEVBQWM3SCxFQUFVNEYsR0FDbkRnQyxFQUF1QixJQUFJQyxFQUFjN0gsRUFBVTZGLEdBQ3pEOEIsRUFBcUJ6RixtQkFDckIwRixFQUFxQjFGLGtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJvamVjdGVpZ2h0Ly4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0ZWlnaHQvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3Byb2plY3RlaWdodC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3Byb2plY3RlaWdodC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJvamVjdGVpZ2h0Ly4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0ZWlnaHQvLi9zcmMvcGFnZS9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0ZWlnaHQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0ZWlnaHQvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3Byb2plY3RlaWdodC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XG4gICAgdGhpcy5mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuYnV0dG9uID0gdGhpcy5mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICAgIHRoaXMuaW5wdXRMaXN0ID0gWy4uLnRoaXMuZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLnNldHRpbmdzLmlucHV0U2VsZWN0b3IpXTtcbiAgfVxuICByZXNldEZvcm1FcnJvcnMoKSB7XG4gICAgdGhpcy5pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0KTtcbiAgICB9KTtcbiAgfVxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uKCk7XG4gICAgdGhpcy5yZXNldEZvcm1FcnJvcnMoKTtcbiAgfVxuXG5cbiAgX2hhc1ZhbGlkSW5wdXRzID0gKCkgPT5cbiAgICB0aGlzLmlucHV0TGlzdC5ldmVyeSgoaW5wdXQpID0+IGlucHV0LnZhbGlkaXR5LnZhbGlkID09PSB0cnVlKTtcblxuICBfZW5hYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLmJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG4gIGRpc2FibGVCdXR0b24oKSB7XG4gICAgdGhpcy5idXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLnNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuYnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgfVxuICBfdG9nZ2xlQnV0dG9uID0gKCkgPT4ge1xuICAgIGlmICh0aGlzLl9oYXNWYWxpZElucHV0cygpKSB7XG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgfVxuICB9O1xuICBfc2hvd0lucHV0RXJyb3IgPSAoaW5wdXQpID0+IHtcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcyB9ID0gdGhpcy5zZXR0aW5ncztcbiAgICBjb25zdCBlcnJvckVsID0gdGhpcy5mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dC5pZH0tZXJyb3JgKTtcbiAgICBlcnJvckVsLnRleHRDb250ZW50ID0gaW5wdXQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgaW5wdXQuY2xhc3NMaXN0LmFkZChpbnB1dEVycm9yQ2xhc3MpO1xuICB9O1xuICBfaGlkZUlucHV0RXJyb3IgPSAoaW5wdXQpID0+IHtcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcyB9ID0gdGhpcy5zZXR0aW5ncztcbiAgICBjb25zdCBlcnJvckVsID0gdGhpcy5mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dC5pZH0tZXJyb3JgKTtcbiAgICBlcnJvckVsLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKGlucHV0RXJyb3JDbGFzcyk7XG4gIH07XG4gIF9jaGVja0lucHV0VmFsaWRpdHkgPSAoaW5wdXQpID0+IHtcbiAgICBpZiAoaW5wdXQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXQsIGlucHV0LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICB9XG4gIH07XG4gIF9zZXRFdmVudExpc3RlbmVyID0gKCkgPT4ge1xuICAgIHRoaXMuaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b24oKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiBldnQucHJldmVudERlZmF1bHQoKSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcigpO1xuICB9XG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcbiIsImV4cG9ydCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoZGF0YSwgY2FyZFRlbXBsYXRlU2VsZWN0b3IsIGhhbmRsZUltYWdlQ2xpY2spIHtcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcbiAgICB0aGlzLl9jYXJkVGVtcGxhdGVTZWxlY3RvciA9IGNhcmRUZW1wbGF0ZVNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICB9XG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRUZW1wbGF0ZVNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpO1xuICB9XG4gIF9oYW5kbGVDYXJkRGVsZXRlQnV0dG9uID0gKCkgPT4gdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG5cbiAgX2hhbmRsZUxpa2VCdXR0b24gPSAoZXZ0KSA9PiB7XG4gICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fZmlsbGVkXCIpO1xuICB9O1xuXG4gIF9hZGRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soKSk7XG4gICAgdGhpcy5fY2FyZERlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgXCJjbGlja1wiLFxuICAgICAgdGhpcy5faGFuZGxlQ2FyZERlbGV0ZUJ1dHRvblxuICAgICk7XG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUxpa2VCdXR0b24pO1xuICB9O1xuXG4gIGNyZWF0ZUNhcmQgPSAoKSA9PiB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpLmNsb25lTm9kZSh0cnVlKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmREZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuY2FyZF9fdHJhc2gtYnV0dG9uXCJcbiAgICApO1xuICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uID1cbiAgICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5fY2FyZEltYWdlLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHt0aGlzLl9kYXRhLmxpbmt9KWA7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKS50ZXh0Q29udGVudCA9XG4gICAgICB0aGlzLl9kYXRhLm5hbWU7XG4gICAgdGhpcy5fYWRkRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH07XG59XG4iLCJleHBvcnQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuICBfaGFuZGxlRXNjQ2xvc2UoZSkge1xuICAgIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlblwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBcIikgfHxcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9fY2xvc2VcIilcbiAgICAgICkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybV9faW5wdXRcIikpO1xuICB9XG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCB2YWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoeyBuYW1lLCB2YWx1ZSB9KSA9PiB7XG4gICAgICB2YWx1ZXNbbmFtZV0gPSB2YWx1ZTtcbiAgICB9KTsgXG4gICAgcmV0dXJuIHZhbHVlcztcbiAgfVxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgIH0pO1xuICB9XG5cbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xuICAgIH0pO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gIH1cbn1cbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxuICB9LFxuXTtcblxuZXhwb3J0IGNvbnN0IHNldHRpbmdzID0ge1xuICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuZm9ybV9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJmb3JtX19pbnB1dF90eXBlLWVycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXQtZXJyb3JcIixcbn07XG5cbi8vIGJ1dHRvbnMgYW5kIG90aGVyIERPTSBlbGVtZW50c1xuXG5leHBvcnQgY29uc3Qgb3BlbkVkaXRNb2RhbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX25hbWUtYnV0dG9uXCJcbik7XG5leHBvcnQgY29uc3Qgb3BlbkFkZENhcmRNb2RhbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX2J1dHRvbi1hZGRcIlxuKTtcbmV4cG9ydCBjb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuXG4vLyBGb3Jtc1xuXG5leHBvcnQgY29uc3QgcHJvZmlsZU1vZGFsRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1fcHJvZmlsZVwiKTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkTW9kYWxGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybV9jYXJkXCIpO1xuZXhwb3J0IGNvbnN0IGlucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXRfdHlwZV9uYW1lXCIpO1xuZXhwb3J0IGNvbnN0IGlucHV0Sm9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX19pbnB1dF90eXBlX2pvYlwiKTtcblxuLy8gUmVzdFxuXG5leHBvcnQgY29uc3QgcG9wdXBBZGRDYXJkU2VsZWN0b3IgPSBcIi5wb3B1cF90eXBlX2FkZC1jYXJkXCI7XG5leHBvcnQgY29uc3QgcG9wdXBQcm9maWxlU2VsZWN0b3IgPSBcIi5wb3B1cF90eXBlX3Byb2ZpbGVcIjtcbmV4cG9ydCBjb25zdCBwb3B1cEltYWdlUHJldmlld1NlbGVjdG9yID0gXCIucG9wdXBfdHlwZV9wcmV2aWV3XCI7XG5leHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlU2VsZWN0b3IgPSBcIiNjYXJkLXRlbXBsYXRlXCI7XG5leHBvcnQgY29uc3QgY2FyZHNMaXN0U2VsZWN0b3IgPSBcIi5jYXJkc19fbGlzdFwiO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lU2VsZWN0b3IgPSBcIi5wcm9maWxlX19uYW1lLWluZm9cIjtcbmV4cG9ydCBjb25zdCBwcm9maWxlSm9iU2VsZWN0b3IgPSBcIi5wcm9maWxlX19pbmZvLWpvYlwiO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRTdWJtaXRCdXR0b24gPSBcIi5mb3JtX19idXR0b25fZGlzYWJsZWRcIjtcbiIsImltcG9ydCAnLi9pbmRleC5jc3MnO1xuXG4vLyBpbXBvcnRzXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCB7IFNlY3Rpb24gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgeyBVc2VySW5mbyB9IGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQge1xuICBpbml0aWFsQ2FyZHMsXG4gIG9wZW5FZGl0TW9kYWxCdXR0b24sXG4gIG9wZW5BZGRDYXJkTW9kYWxCdXR0b24sXG4gIGNhcmRzTGlzdCxcbiAgcHJvZmlsZU1vZGFsRm9ybSxcbiAgYWRkQ2FyZE1vZGFsRm9ybSxcbiAgaW5wdXROYW1lLFxuICBpbnB1dEpvYixcbiAgc2V0dGluZ3MsXG4gIHBvcHVwQWRkQ2FyZFNlbGVjdG9yLFxuICBwb3B1cFByb2ZpbGVTZWxlY3RvcixcbiAgcG9wdXBJbWFnZVByZXZpZXdTZWxlY3RvcixcbiAgY2FyZFRlbXBsYXRlU2VsZWN0b3IsXG4gIGNhcmRzTGlzdFNlbGVjdG9yLFxuICBwcm9maWxlTmFtZVNlbGVjdG9yLFxuICBwcm9maWxlSm9iU2VsZWN0b3IsXG4gIGFkZENhcmRTdWJtaXRCdXR0b24sXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcblxuXG5cbi8vIGluc3RhbmNlc1xuXG5jb25zdCBoYW5kbGVBZGRDYXJkU3VibWl0ID0gKGRhdGEpID0+IHtcbiAgcmVuZGVyQ2FyZCh7IG5hbWU6IGRhdGFbXCJ0aXRsZVwiXSwgbGluazogZGF0YVtcImxpbmtcIl0gfSwgY2FyZHNMaXN0KTtcbiAgYWRkQ2FyZFBvcHVwLmNsb3NlKCk7XG59O1xuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIHBvcHVwQWRkQ2FyZFNlbGVjdG9yLFxuICBoYW5kbGVBZGRDYXJkU3VibWl0XG4pO1xuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0ID0gKGRhdGEpID0+IHtcbiAgdXNlckluZm8uc2V0VXNlckluZm8oZGF0YS5uYW1lLCBkYXRhLmpvYik7XG4gIGFkZFByb2ZpbGVQb3B1cC5jbG9zZSgpO1xufTtcblxuY29uc3QgYWRkUHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIHBvcHVwUHJvZmlsZVNlbGVjdG9yLFxuICBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdFxuKTtcbmFkZFByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKHBvcHVwSW1hZ2VQcmV2aWV3U2VsZWN0b3IpO1xuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyByZW5kZXJjYXJkXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGRhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKGRhdGEsIGNhcmRUZW1wbGF0ZVNlbGVjdG9yLCAoKSA9PiB7XG4gICAgaW1hZ2VQb3B1cC5vcGVuKGRhdGEubmFtZSwgZGF0YS5saW5rKTtcbiAgfSk7XG5cbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkLmNyZWF0ZUNhcmQoKTtcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xufVxuXG5jb25zdCByZW5kZXJDYXJkID0gKGRhdGEpID0+IHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGRhdGEpO1xuICBzZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xufTtcblxuY29uc3Qgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICB7IGl0ZW1zOiBpbml0aWFsQ2FyZHMsIHJlbmRlcmVyOiByZW5kZXJDYXJkIH0sXG4gIGNhcmRzTGlzdFNlbGVjdG9yXG4pO1xuc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICBwcm9maWxlTmFtZVNlbGVjdG9yOiBwcm9maWxlTmFtZVNlbGVjdG9yLFxuICBwcm9maWxlSm9iU2VsZWN0b3I6IHByb2ZpbGVKb2JTZWxlY3Rvcixcbn0pO1xuLy8gZXZlbnRIYW5kbGVyc1xub3BlbkVkaXRNb2RhbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICBjb25zdCBwcm9maWxlRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIGFkZFByb2ZpbGVQb3B1cC5vcGVuKCk7XG4gIGFkZFByb2ZpbGVQb3B1cC5zZXRJbnB1dFZhbHVlcyhwcm9maWxlRGF0YSk7XG4gIHByb2ZpbGVGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpOyBcbn0pO1xuXG5vcGVuQWRkQ2FyZE1vZGFsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XG4gIFxuICBhZGRDYXJkRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XG4gIGFkZENhcmRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xufSk7XG5cbi8vIGZvcm1cbmNvbnN0IHByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIHByb2ZpbGVNb2RhbEZvcm0pO1xuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgYWRkQ2FyZE1vZGFsRm9ybSk7XG5wcm9maWxlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hZGRDYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cblxuXG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgb3BlbihuYW1lLCBsaW5rKSB7XG4gICAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcbiAgICBjb25zdCBjYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2FwdGlvblwiKTsgIC8vIFNlbGVjdCB0aGUgY2FwdGlvbiBlbGVtZW50XG4gICAgXG4gICAgaW1hZ2Uuc3JjID0gbGluaztcbiAgICBpbWFnZS5hbHQgPSBuYW1lO1xuICAgIGNhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lOyAgLy8gVXBkYXRlIHRoZSBjYXB0aW9uXG4gICAgXG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2godGhpcy5fcmVuZGVyZXIpO1xuICB9XG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IHByb2ZpbGVOYW1lU2VsZWN0b3IsIHByb2ZpbGVKb2JTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVOYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX3Byb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVKb2JTZWxlY3Rvcik7XG4gIH1cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50LFxuICAgICAgam9iOiB0aGlzLl9wcm9maWxlSm9iLnRleHRDb250ZW50LFxuICAgIH07XG4gIH1cbiAgc2V0VXNlckluZm8obmFtZSwgam9iKSB7XG4gICAgdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX3Byb2ZpbGVKb2IudGV4dENvbnRlbnQgPSBqb2I7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiYnV0dG9uIiwicXVlcnlTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJyZXNldEZvcm1FcnJvcnMiLCJmb3JFYWNoIiwiaW5wdXQiLCJfaGlkZUlucHV0RXJyb3IiLCJyZXNldFZhbGlkYXRpb24iLCJfdG9nZ2xlQnV0dG9uIiwiX2hhc1ZhbGlkSW5wdXRzIiwiZXZlcnkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2VuYWJsZUJ1dHRvbiIsImNsYXNzTGlzdCIsInJlbW92ZSIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJkaXNhYmxlZCIsImRpc2FibGVCdXR0b24iLCJhZGQiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVycm9yQ2xhc3MiLCJpZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3NldEV2ZW50TGlzdGVuZXIiLCJhZGRFdmVudExpc3RlbmVyIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiQ2FyZCIsImRhdGEiLCJjYXJkVGVtcGxhdGVTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJfZGF0YSIsIl9jYXJkVGVtcGxhdGVTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJjb250ZW50IiwiX2hhbmRsZUNhcmREZWxldGVCdXR0b24iLCJfY2FyZEVsZW1lbnQiLCJfaGFuZGxlTGlrZUJ1dHRvbiIsInRhcmdldCIsInRvZ2dsZSIsIl9hZGRFdmVudExpc3RlbmVycyIsIl9jYXJkSW1hZ2UiLCJfY2FyZERlbGV0ZUJ1dHRvbiIsIl9jYXJkTGlrZUJ1dHRvbiIsImNyZWF0ZUNhcmQiLCJjbG9uZU5vZGUiLCJzdHlsZSIsImJhY2tncm91bmRJbWFnZSIsImxpbmsiLCJuYW1lIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsImUiLCJrZXkiLCJjbG9zZSIsIm9wZW4iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVTdWJtaXQiLCJfZm9ybSIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJfZ2V0SW5wdXRWYWx1ZXMiLCJ2YWx1ZXMiLCJfcmVmIiwidmFsdWUiLCJzZXRJbnB1dFZhbHVlcyIsInJlc2V0IiwiZXJyb3JDbGFzcyIsIm9wZW5FZGl0TW9kYWxCdXR0b24iLCJvcGVuQWRkQ2FyZE1vZGFsQnV0dG9uIiwiY2FyZHNMaXN0IiwicHJvZmlsZU1vZGFsRm9ybSIsImFkZENhcmRNb2RhbEZvcm0iLCJhZGRDYXJkUG9wdXAiLCJyZW5kZXJDYXJkIiwiYWRkUHJvZmlsZVBvcHVwIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsImpvYiIsImltYWdlUG9wdXAiLCJpbWFnZSIsImNhcHRpb24iLCJzcmMiLCJhbHQiLCJjYXJkRWxlbWVudCIsInNlY3Rpb24iLCJhZGRJdGVtIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiZWxlbWVudCIsInByZXBlbmQiLCJwcm9maWxlTmFtZVNlbGVjdG9yIiwicHJvZmlsZUpvYlNlbGVjdG9yIiwiX3Byb2ZpbGVOYW1lIiwiX3Byb2ZpbGVKb2IiLCJnZXRVc2VySW5mbyIsInByb2ZpbGVEYXRhIiwicHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJhZGRDYXJkRm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiXSwic291cmNlUm9vdCI6IiJ9